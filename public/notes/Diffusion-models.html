<!DOCTYPE html>
<html lang="en"><head><title>Diffusion models</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM Plex Mono&amp;family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:title" content="Diffusion models"/><meta property="og:description" content="Diffusion models Setup q(y): true sampling distribution of observed data p_\theta(y): learned sampling distribution \text{x}^{1:T}: noisy latent variables at each step t Forward ..."/><meta property="og:image" content="https://whoisnnamdi.com/notes/static/og-image.png"/><meta property="og:width" content="1200"/><meta property="og:height" content="675"/><link rel="icon" href="/notes/static/icon.png"/><meta name="description" content="Diffusion models Setup q(y): true sampling distribution of observed data p_\theta(y): learned sampling distribution \text{x}^{1:T}: noisy latent variables at each step t Forward ..."/><meta name="generator" content="Quartz"/><link href="/notes/index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="/notes/prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("/notes/static/contentIndex.json").then(data => data.json())</script></head><body data-slug="Diffusion-models"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h1 class="page-title"><a href="/notes/">Nnamdi's Notes</a></h1><div class="spacer mobile-only"></div><div class="search"><div id="search-icon"><p>Search</p><div></div><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search</title><desc id="desc">Search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></div><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="search-layout" data-preview="true"></div></div></div></div><div class="darkmode"><input class="toggle" id="darkmode-toggle" type="checkbox" tabindex="-1"/><label id="toggle-label-light" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg></label><label id="toggle-label-dark" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></label></div><div class="explorer desktop-only"><button type="button" id="explorer" data-behavior="collapse" data-collapsed="collapsed" data-savestate="true" data-tree="[]"><h1>All Notes</h1><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-content"><ul class="overflow" id="explorer-ul"><li><div class="folder-outer open"><ul style="padding-left:0;" class="content" data-folderul><li><div class="folder-outer "><ul style="padding-left:0;" class="content" data-folderul></ul></div></li><li><a href="/notes/@dubeLocalProjectionsApproach/" data-for="@dubeLocalProjectionsApproach">A Local Projections Approach to Difference-in-Differences Event Studies</a></li><li><a href="/notes/@gouletcoulombeNeuralPhillipsCurve2022/" data-for="@gouletcoulombeNeuralPhillipsCurve2022">A Neural Phillips Curve and a Deep Output Gap</a></li><li><a href="/notes/agency/" data-for="agency">agency</a></li><li><a href="/notes/@hodrickExplorationTrendCycleDecomposition2020/" data-for="@hodrickExplorationTrendCycleDecomposition2020">An Exploration of Trend-Cycle Decomposition Methodologies in Simulated Data</a></li><li><a href="/notes/Autoregressive-models/" data-for="Autoregressive-models">Autoregressive models</a></li><li><a href="/notes/Ben-Franklin's-Autoencoder/" data-for="Ben-Franklin's-Autoencoder">Ben Franklin's Autoencoder</a></li><li><a href="/notes/Beveridge-Nelson-Decomposition/" data-for="Beveridge-Nelson-Decomposition">Beveridge-Nelson Decomposition</a></li><li><a href="/notes/@phillipsBoostingWhyYou2021/" data-for="@phillipsBoostingWhyYou2021">Boosting: Why You Can Use the Hp Filter</a></li><li><a href="/notes/Career-success-and-career-capital-are-cointegrated/" data-for="Career-success-and-career-capital-are-cointegrated">Career success and career capital are cointegrated</a></li><li><a href="/notes/Careers-are-a-random-walk/" data-for="Careers-are-a-random-walk">Careers are a random walk</a></li><li><a href="/notes/Change-leads-to-insight-far-more-often-than-insight-leads-to-change/" data-for="Change-leads-to-insight-far-more-often-than-insight-leads-to-change">Change leads to insight far more often than insight leads to change</a></li><li><a href="/notes/Correlation-between-prices-and-quantities-reveals-main-market-driver/" data-for="Correlation-between-prices-and-quantities-reveals-main-market-driver">Correlation between prices and quantities reveals main market driver</a></li><li><a href="/notes/Diffusion-models/" data-for="Diffusion-models">Diffusion models</a></li><li><a href="/notes/Don't-detrend-random-walks-with-linear-trends/" data-for="Don't-detrend-random-walks-with-linear-trends">Don't detrend random walks with linear trends</a></li><li><a href="/notes/Don't-rely-on-inspiration-to-write/" data-for="Don't-rely-on-inspiration-to-write">Don't rely on inspiration to write</a></li><li><a href="/notes/@vivianoDynamicCovariateBalancing2023/" data-for="@vivianoDynamicCovariateBalancing2023">Dynamic covariate balancing: Estimating treatment effects over time with potential local projections</a></li><li><a href="/notes/Dynamic-factor-model/" data-for="Dynamic-factor-model">Dynamic factor model</a></li><li><a href="/notes/@stockDynamicFactorModels2016/" data-for="@stockDynamicFactorModels2016">Dynamic Factor Models, Factor-Augmented Vector Autoregressions, and Structural Vector Autoregressions in Macroeconomics</a></li><li><a href="/notes/@plagborg-mollerEssaysMacroeconometrics/" data-for="@plagborg-mollerEssaysMacroeconometrics">Essays in Macroeconometrics</a></li><li><a href="/notes/Exponentials-drive-asymmetry/" data-for="Exponentials-drive-asymmetry">Exponentials drive asymmetry</a></li><li><a href="/notes/@canovaFAQHowExtract/" data-for="@canovaFAQHowExtract">FAQ: How do I extract the output gap?</a></li><li><a href="/notes/Fat-tails-preclude-ergodicity/" data-for="Fat-tails-preclude-ergodicity">Fat tails preclude ergodicity</a></li><li><a href="/notes/First-impression-are-high-variance/" data-for="First-impression-are-high-variance">First impression are high variance</a></li><li><a href="/notes/Focus-on-the-residuals/" data-for="Focus-on-the-residuals">Focus on the residuals</a></li><li><a href="/notes/For-the-effectual-reasoner,-residuals-are-inputs-rather-than-outputs/" data-for="For-the-effectual-reasoner,-residuals-are-inputs-rather-than-outputs">For the effectual reasoner, residuals are inputs rather than outputs</a></li><li><a href="/notes/@gorodnichenkoForecastErrorVariance2020/" data-for="@gorodnichenkoForecastErrorVariance2020">Forecast Error Variance Decompositions with Local Projections</a></li><li><a href="/notes/@bardsenForecastingLevelsLog2011/" data-for="@bardsenForecastingLevelsLog2011">Forecasting levels of log variables in vector autoregressions</a></li><li><a href="/notes/@atheyGeneralizedRandomForests2018/" data-for="@atheyGeneralizedRandomForests2018">Generalized Random Forests</a></li><li><a href="/notes/Get-leverage-on-the-fixed-cost-of-pain/" data-for="Get-leverage-on-the-fixed-cost-of-pain">Get leverage on the fixed cost of pain</a></li><li><a href="/notes/Goals-should-be-binomial/" data-for="Goals-should-be-binomial">Goals should be binomial</a></li><li><a href="/notes/Good-ideas-are-testable-ideas/" data-for="Good-ideas-are-testable-ideas">Good ideas are testable ideas</a></li><li><a href="/notes/Good-representations-reduce-sample-complexity-of-downstream-tasks/" data-for="Good-representations-reduce-sample-complexity-of-downstream-tasks">Good representations reduce sample complexity of downstream tasks</a></li><li><a href="/notes/Granular-IV/" data-for="Granular-IV">Granular IV</a></li><li><a href="/notes/Granularity/" data-for="Granularity">Granularity</a></li><li><a href="/notes/@jonesGrowthIdeas2005/" data-for="@jonesGrowthIdeas2005">Growth and Ideas</a></li><li><a href="/notes/Hamilton-filter/" data-for="Hamilton-filter">Hamilton filter</a></li><li><a href="/notes/Highly-likely-events-do-not-yield-much-information/" data-for="Highly-likely-events-do-not-yield-much-information">Highly likely events do not yield much information</a></li><li><a href="/notes/@cochraneHowBigRandom1988/" data-for="@cochraneHowBigRandom1988">How Big Is the Random Walk in GNP?</a></li><li><a href="/notes/@haddadHowCompetitiveStock2021/" data-for="@haddadHowCompetitiveStock2021">How Competitive is the Stock Market? Theory, Evidence from Portfolios, and Implications for the Rise of Passive Investing</a></li><li><a href="/notes/@greenwaldHowWealthWas/" data-for="@greenwaldHowWealthWas">How the Wealth Was Won: Factor Shares as Market Fundamentals</a></li><li><a href="/notes/Ideas-generate-increasing-returns-because-they-are-nonrivalrous/" data-for="Ideas-generate-increasing-returns-because-they-are-nonrivalrous">Ideas generate increasing returns because they are nonrivalrous</a></li><li><a href="/notes/@stockIdentificationEstimationDynamic2018/" data-for="@stockIdentificationEstimationDynamic2018">Identification and Estimation of Dynamic Causal Effects in Macroeconomics Using External Instruments</a></li><li><a href="/notes/If-you're-not-sure-something-is-getting-better,-it's-not/" data-for="If-you're-not-sure-something-is-getting-better,-it's-not">If you're not sure something is getting better, it's not</a></li><li><a href="/notes/@barnichonImpulseResponseEstimation2019/" data-for="@barnichonImpulseResponseEstimation2019">Impulse Response Estimation by Smooth Local Projections</a></li><li><a href="/notes/In-the-long-run,-all-costs-are-variable/" data-for="In-the-long-run,-all-costs-are-variable">In the long-run, all costs are variable</a></li><li><a href="/notes/@barigozziInferenceHeavyTailedNonstationary2022/" data-for="@barigozziInferenceHeavyTailedNonstationary2022">Inference in Heavy-Tailed Nonstationary Multivariate Time Series</a></li><li><a href="/notes/Information-is-relative/" data-for="Information-is-relative">Information is relative</a></li><li><a href="/notes/Information-is-surprisal/" data-for="Information-is-surprisal">Information is surprisal</a></li><li><a href="/notes/Interaction-generates-non-normality/" data-for="Interaction-generates-non-normality">Interaction generates non-normality</a></li><li><a href="/notes/Invest-in-companies-like-you-invest-in-your-career/" data-for="Invest-in-companies-like-you-invest-in-your-career">Invest in companies like you invest in your career</a></li><li><a href="/notes/Iterative-tinkering-enhances-effective-IQ/" data-for="Iterative-tinkering-enhances-effective-IQ">Iterative tinkering enhances effective IQ</a></li><li><a href="/notes/Just-do-more/" data-for="Just-do-more">Just do more</a></li><li><a href="/notes/Labor-relationships-have-debt-like-features/" data-for="Labor-relationships-have-debt-like-features">Labor relationships have debt-like features</a></li><li><a href="/notes/@barigozziLargedimensionalDynamicFactor2021/" data-for="@barigozziLargedimensionalDynamicFactor2021">Large-dimensional Dynamic Factor Models: Estimation of Impulse–Response Functions with I ( 1 ) cointegrated factors</a></li><li><a href="/notes/@adamekLassoInferenceHighDimensional2022/" data-for="@adamekLassoInferenceHighDimensional2022">Lasso Inference for High-Dimensional Time Series</a></li><li><a href="/notes/Learned-representations-are-more-important-than-what-you-do-with-them/" data-for="Learned-representations-are-more-important-than-what-you-do-with-them">Learned representations are more important than what you do with them</a></li><li><a href="/notes/@axlerLinearAlgebraDone/" data-for="@axlerLinearAlgebraDone">Linear Algebra Done Right</a></li><li><a href="/notes/Linearly-separable-problems-are-easy-to-solve/" data-for="Linearly-separable-problems-are-easy-to-solve">Linearly separable problems are easy to solve</a></li><li><a href="/notes/Local-projections/" data-for="Local-projections">Local projections</a></li><li><a href="/notes/Local-projections-vs.-VARs" data-for="Local-projections-vs.-VARs">Local projections vs. VARs</a></li><li><a href="/notes/@liLocalProjectionsVs2023/" data-for="@liLocalProjectionsVs2023">Local Projections vs. VARs: Lessons From Thousands of DGPs</a></li><li><a href="/notes/Look-for-high-talent-and-high-agency/" data-for="Look-for-high-talent-and-high-agency">Look for high talent and high agency</a></li><li><a href="/notes/@nowakMathematicalFoundationsMachine/" data-for="@nowakMathematicalFoundationsMachine">Mathematical Foundations of Machine Learning</a></li><li><a href="/notes/Maximize-the-entropy-of-your-information-sources/" data-for="Maximize-the-entropy-of-your-information-sources">Maximize the entropy of your information sources</a></li><li><a href="/notes/Maximize-your-output-of-testable-ideas/" data-for="Maximize-your-output-of-testable-ideas">Maximize your output of testable ideas</a></li><li><a href="/notes/@karapanagiotiModelSelectionLocal/" data-for="@karapanagiotiModelSelectionLocal">Model Selection for Local Projections Instrumental Variable Methods - Empirical Application to Government Spending Multipliers.</a></li><li><a href="/notes/@jordaModelFreeImpulseResponses2003/" data-for="@jordaModelFreeImpulseResponses2003">Model-Free Impulse Responses</a></li><li><a href="/notes/Moving-average-model/" data-for="Moving-average-model">Moving average model</a></li><li><a href="/notes/Network-egress-is-a-lock-in-tactic-for-public-cloud-providers/" data-for="Network-egress-is-a-lock-in-tactic-for-public-cloud-providers">Network egress is a lock-in tactic for public cloud providers</a></li><li><a href="/notes/Not-all-spurious-correlation-is-random/" data-for="Not-all-spurious-correlation-is-random">Not all spurious correlation is random</a></li><li><a href="/notes/Observe-before-you-analyze/" data-for="Observe-before-you-analyze">Observe before you analyze</a></li><li><a href="/notes/@greenwaldOriginsStockMarket2014/" data-for="@greenwaldOriginsStockMarket2014">Origins of Stock Market Fluctuations</a></li><li><a href="/notes/Perfect-competition-is-not-optimal-under-increasing-returns-to-scale/" data-for="Perfect-competition-is-not-optimal-under-increasing-returns-to-scale">Perfect competition is not optimal under increasing returns to scale</a></li><li><a href="/notes/Planning-your-time-is-like-choosing-to-dance-on-beat/" data-for="Planning-your-time-is-like-choosing-to-dance-on-beat">Planning your time is like choosing to dance on beat</a></li><li><a href="/notes/Pre-train-your-representations-before-learning-judgement/" data-for="Pre-train-your-representations-before-learning-judgement">Pre-train your representations before learning judgement</a></li><li><a href="/notes/Prediction-is-compression,-compression-is-expression/" data-for="Prediction-is-compression,-compression-is-expression">Prediction is compression, compression is expression</a></li><li><a href="/notes/Principal-component-analysis/" data-for="Principal-component-analysis">Principal component analysis</a></li><li><a href="/notes/@hamiltonPrincipalComponentAnalysis/" data-for="@hamiltonPrincipalComponentAnalysis">Principal Component Analysis for Nonstationary Series</a></li><li><a href="/notes/@baiPrincipalComponentsEstimation2013/" data-for="@baiPrincipalComponentsEstimation2013">Principal components estimation and identification of static factors</a></li><li><a href="/notes/Random-walk/" data-for="Random-walk">Random walk</a></li><li><a href="/notes/residuals/" data-for="residuals">residuals</a></li><li><a href="/notes/self-supervised-learning/" data-for="self-supervised-learning">self-supervised learning</a></li><li><a href="/notes/@budaShortVariableLags2023/" data-for="@budaShortVariableLags2023">Short and Variable Lags</a></li><li><a href="/notes/@crumpSparseTrendEstimation2023/" data-for="@crumpSparseTrendEstimation2023">Sparse Trend Estimation</a></li><li><a href="/notes/@hsuSubsetSelectionVector2008/" data-for="@hsuSubsetSelectionVector2008">Subset selection for vector autoregressive processes using Lasso</a></li><li><a href="/notes/@taylorSystematicShiftsScaling2021/" data-for="@taylorSystematicShiftsScaling2021">Systematic shifts in scaling behavior based on organizational strategy in universities</a></li><li><a href="/notes/@hoyosTariffsGrowthHeterogeneous/" data-for="@hoyosTariffsGrowthHeterogeneous">Tariffs and Growth: Heterogeneous Eﬀects by Economic Structure</a></li><li><a href="/notes/@zouAdaptiveLassoIts2006/" data-for="@zouAdaptiveLassoIts2006">The Adaptive Lasso and Its Oracle Properties</a></li><li><a href="/notes/@parkBayesianLasso2008/" data-for="@parkBayesianLasso2008">The Bayesian Lasso</a></li><li><a href="/notes/@fernaldDisappointingRecoveryOutput2017/" data-for="@fernaldDisappointingRecoveryOutput2017">The Disappointing Recovery of Output after 2009</a></li><li><a href="/notes/@bayerLiquidityChannelFiscal2020/" data-for="@bayerLiquidityChannelFiscal2020">The Liquidity Channel of Fiscal Policy</a></li><li><a href="/notes/Under-fat-tails,-look-for-quick-reasons-to-say-yes/" data-for="Under-fat-tails,-look-for-quick-reasons-to-say-yes">Under fat tails, look for quick reasons to say yes</a></li><li><a href="/notes/Under-fat-tails,-outliers-drive-movements-in-the-mean/" data-for="Under-fat-tails,-outliers-drive-movements-in-the-mean">Under fat tails, outliers drive movements in the mean</a></li><li><a href="/notes/Under-fat-tails,-unbiasedness-is-overrated/" data-for="Under-fat-tails,-unbiasedness-is-overrated">Under fat tails, unbiasedness is overrated</a></li><li><a href="/notes/Use-TK-liberally/" data-for="Use-TK-liberally">Use TK liberally</a></li><li><a href="/notes/variance/" data-for="variance">variance</a></li><li><a href="/notes/Vector-autoregression/" data-for="Vector-autoregression">Vector autoregression</a></li><li><a href="/notes/@bardesVICRegVarianceInvarianceCovarianceRegularization2021/" data-for="@bardesVICRegVarianceInvarianceCovarianceRegularization2021">VICReg: Variance-Invariance-Covariance Regularization for Self-Supervised Learning</a></li><li><a href="/notes/Volatility-is-information/" data-for="Volatility-is-information">Volatility is information</a></li><li><a href="/notes/When-in-doubt,-don't-difference/" data-for="When-in-doubt,-don't-difference">When in doubt, don't difference</a></li><li><a href="/notes/When-unskilled,-complicate-the-game-and-add-randomness/" data-for="When-unskilled,-complicate-the-game-and-add-randomness">When unskilled, complicate the game and add randomness</a></li><li><a href="/notes/With-the-right-representation,-judgement-is-cheap/" data-for="With-the-right-representation,-judgement-is-cheap">With the right representation, judgement is cheap</a></li></ul></div></li><li id="explorer-end"></li></ul></div></div></div><div class="center"><div class="page-header"><div class="popover-hint"></div></div><article class="popover-hint"><h1 id="diffusion-models">Diffusion models<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#diffusion-models" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<h2 id="setup">Setup<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#setup" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>: true sampling distribution of observed data</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>: learned sampling distribution</li>
<li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span>: noisy latent variables at each step <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></li>
</ul>
<h2 id="forward-process">Forward process<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#forward-process" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>In the forward process, noise is continuously added to the data across multiple steps, converging toward white noise <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.085em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.835em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.795em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.205em;"><span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord text"><span class="mord">I</span></span><span class="mclose">)</span></span></span></span>
The fixed Gaussian forward process means we can directly calculate/sample from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0436em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> without calculating all the intermediate steps (similar to <a href="/notes/Autoregressive-models/" class="internal alias" data-slug="Autoregressive-models">Autoregressive models</a>):
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7936em;"></span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.2461em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7939em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7539em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2461em;"><span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.305em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.935em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.895em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.305em;"><span></span></span></span></span></span><span class="mord mathnormal">ϵ</span></span></span></span>
Where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7178em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2332em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9335em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span> is white noise. Again, this is 100% analogous to the forecasting equation for an AR(1).</p>
<p>In practice, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is chosen to be close to 1, as this yields the best results.</p>
<h2 id="denoising">Denoising<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#denoising" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>In the denoising or reverse diffusion process, noise is progressively removed over multiple steps, modeling the inverse process:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0436em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord text"><span class="mord">I</span></span><span class="mclose">)</span></span></span></span>
Where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.348em;vertical-align:-0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9029em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4518em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2025em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<p><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is parameterized using a denoising network, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> (of which many exist, including the popular U-Net):
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0436em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.404em;vertical-align:-0.5589em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7344em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.6944em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3056em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5589em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.4702em;vertical-align:-0.538em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.6011em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0037em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8013em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1987em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.0528em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">))</span></span></span></span>
This model is trained using the objective function:
<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0797em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">ϵ</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord">∣∣</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϵ</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></p>
<hr/>
<h2 id="references">References<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#references" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p><a href="/notes/@kolloviehPredictRefineSynthesize2023/" class="internal" data-slug="@kolloviehPredictRefineSynthesize2023">@kolloviehPredictRefineSynthesize2023</a></p>
<p><a href="/notes/@harveyFlexibleDiffusionModeling2022/" class="internal" data-slug="@harveyFlexibleDiffusionModeling2022">@harveyFlexibleDiffusionModeling2022</a></p>
<p><a href="/notes/tags/e/" class="tag-link internal alias" data-slug="tags/e">e</a><a href="/notes/tags/online/" class="tag-link internal alias" data-slug="tags/online">online</a></p></article></div><div class="right sidebar"><div class="backlinks"><h3>Backlinks</h3><ul class="overflow"><li>No backlinks found</li></ul></div><div class="explorer mobile-only"><button type="button" id="explorer" data-behavior="collapse" data-collapsed="collapsed" data-savestate="true" data-tree="[]"><h1>All Notes</h1><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-content"><ul class="overflow" id="explorer-ul"><li><div class="folder-outer open"><ul style="padding-left:0;" class="content" data-folderul><li><div class="folder-outer "><ul style="padding-left:0;" class="content" data-folderul></ul></div></li><li><a href="/notes/@dubeLocalProjectionsApproach/" data-for="@dubeLocalProjectionsApproach">A Local Projections Approach to Difference-in-Differences Event Studies</a></li><li><a href="/notes/@gouletcoulombeNeuralPhillipsCurve2022/" data-for="@gouletcoulombeNeuralPhillipsCurve2022">A Neural Phillips Curve and a Deep Output Gap</a></li><li><a href="/notes/agency/" data-for="agency">agency</a></li><li><a href="/notes/@hodrickExplorationTrendCycleDecomposition2020/" data-for="@hodrickExplorationTrendCycleDecomposition2020">An Exploration of Trend-Cycle Decomposition Methodologies in Simulated Data</a></li><li><a href="/notes/Autoregressive-models/" data-for="Autoregressive-models">Autoregressive models</a></li><li><a href="/notes/Ben-Franklin's-Autoencoder/" data-for="Ben-Franklin's-Autoencoder">Ben Franklin's Autoencoder</a></li><li><a href="/notes/Beveridge-Nelson-Decomposition/" data-for="Beveridge-Nelson-Decomposition">Beveridge-Nelson Decomposition</a></li><li><a href="/notes/@phillipsBoostingWhyYou2021/" data-for="@phillipsBoostingWhyYou2021">Boosting: Why You Can Use the Hp Filter</a></li><li><a href="/notes/Career-success-and-career-capital-are-cointegrated/" data-for="Career-success-and-career-capital-are-cointegrated">Career success and career capital are cointegrated</a></li><li><a href="/notes/Careers-are-a-random-walk/" data-for="Careers-are-a-random-walk">Careers are a random walk</a></li><li><a href="/notes/Change-leads-to-insight-far-more-often-than-insight-leads-to-change/" data-for="Change-leads-to-insight-far-more-often-than-insight-leads-to-change">Change leads to insight far more often than insight leads to change</a></li><li><a href="/notes/Correlation-between-prices-and-quantities-reveals-main-market-driver/" data-for="Correlation-between-prices-and-quantities-reveals-main-market-driver">Correlation between prices and quantities reveals main market driver</a></li><li><a href="/notes/Diffusion-models/" data-for="Diffusion-models">Diffusion models</a></li><li><a href="/notes/Don't-detrend-random-walks-with-linear-trends/" data-for="Don't-detrend-random-walks-with-linear-trends">Don't detrend random walks with linear trends</a></li><li><a href="/notes/Don't-rely-on-inspiration-to-write/" data-for="Don't-rely-on-inspiration-to-write">Don't rely on inspiration to write</a></li><li><a href="/notes/@vivianoDynamicCovariateBalancing2023/" data-for="@vivianoDynamicCovariateBalancing2023">Dynamic covariate balancing: Estimating treatment effects over time with potential local projections</a></li><li><a href="/notes/Dynamic-factor-model/" data-for="Dynamic-factor-model">Dynamic factor model</a></li><li><a href="/notes/@stockDynamicFactorModels2016/" data-for="@stockDynamicFactorModels2016">Dynamic Factor Models, Factor-Augmented Vector Autoregressions, and Structural Vector Autoregressions in Macroeconomics</a></li><li><a href="/notes/@plagborg-mollerEssaysMacroeconometrics/" data-for="@plagborg-mollerEssaysMacroeconometrics">Essays in Macroeconometrics</a></li><li><a href="/notes/Exponentials-drive-asymmetry/" data-for="Exponentials-drive-asymmetry">Exponentials drive asymmetry</a></li><li><a href="/notes/@canovaFAQHowExtract/" data-for="@canovaFAQHowExtract">FAQ: How do I extract the output gap?</a></li><li><a href="/notes/Fat-tails-preclude-ergodicity/" data-for="Fat-tails-preclude-ergodicity">Fat tails preclude ergodicity</a></li><li><a href="/notes/First-impression-are-high-variance/" data-for="First-impression-are-high-variance">First impression are high variance</a></li><li><a href="/notes/Focus-on-the-residuals/" data-for="Focus-on-the-residuals">Focus on the residuals</a></li><li><a href="/notes/For-the-effectual-reasoner,-residuals-are-inputs-rather-than-outputs/" data-for="For-the-effectual-reasoner,-residuals-are-inputs-rather-than-outputs">For the effectual reasoner, residuals are inputs rather than outputs</a></li><li><a href="/notes/@gorodnichenkoForecastErrorVariance2020/" data-for="@gorodnichenkoForecastErrorVariance2020">Forecast Error Variance Decompositions with Local Projections</a></li><li><a href="/notes/@bardsenForecastingLevelsLog2011/" data-for="@bardsenForecastingLevelsLog2011">Forecasting levels of log variables in vector autoregressions</a></li><li><a href="/notes/@atheyGeneralizedRandomForests2018/" data-for="@atheyGeneralizedRandomForests2018">Generalized Random Forests</a></li><li><a href="/notes/Get-leverage-on-the-fixed-cost-of-pain/" data-for="Get-leverage-on-the-fixed-cost-of-pain">Get leverage on the fixed cost of pain</a></li><li><a href="/notes/Goals-should-be-binomial/" data-for="Goals-should-be-binomial">Goals should be binomial</a></li><li><a href="/notes/Good-ideas-are-testable-ideas/" data-for="Good-ideas-are-testable-ideas">Good ideas are testable ideas</a></li><li><a href="/notes/Good-representations-reduce-sample-complexity-of-downstream-tasks/" data-for="Good-representations-reduce-sample-complexity-of-downstream-tasks">Good representations reduce sample complexity of downstream tasks</a></li><li><a href="/notes/Granular-IV/" data-for="Granular-IV">Granular IV</a></li><li><a href="/notes/Granularity/" data-for="Granularity">Granularity</a></li><li><a href="/notes/@jonesGrowthIdeas2005/" data-for="@jonesGrowthIdeas2005">Growth and Ideas</a></li><li><a href="/notes/Hamilton-filter/" data-for="Hamilton-filter">Hamilton filter</a></li><li><a href="/notes/Highly-likely-events-do-not-yield-much-information/" data-for="Highly-likely-events-do-not-yield-much-information">Highly likely events do not yield much information</a></li><li><a href="/notes/@cochraneHowBigRandom1988/" data-for="@cochraneHowBigRandom1988">How Big Is the Random Walk in GNP?</a></li><li><a href="/notes/@haddadHowCompetitiveStock2021/" data-for="@haddadHowCompetitiveStock2021">How Competitive is the Stock Market? Theory, Evidence from Portfolios, and Implications for the Rise of Passive Investing</a></li><li><a href="/notes/@greenwaldHowWealthWas/" data-for="@greenwaldHowWealthWas">How the Wealth Was Won: Factor Shares as Market Fundamentals</a></li><li><a href="/notes/Ideas-generate-increasing-returns-because-they-are-nonrivalrous/" data-for="Ideas-generate-increasing-returns-because-they-are-nonrivalrous">Ideas generate increasing returns because they are nonrivalrous</a></li><li><a href="/notes/@stockIdentificationEstimationDynamic2018/" data-for="@stockIdentificationEstimationDynamic2018">Identification and Estimation of Dynamic Causal Effects in Macroeconomics Using External Instruments</a></li><li><a href="/notes/If-you're-not-sure-something-is-getting-better,-it's-not/" data-for="If-you're-not-sure-something-is-getting-better,-it's-not">If you're not sure something is getting better, it's not</a></li><li><a href="/notes/@barnichonImpulseResponseEstimation2019/" data-for="@barnichonImpulseResponseEstimation2019">Impulse Response Estimation by Smooth Local Projections</a></li><li><a href="/notes/In-the-long-run,-all-costs-are-variable/" data-for="In-the-long-run,-all-costs-are-variable">In the long-run, all costs are variable</a></li><li><a href="/notes/@barigozziInferenceHeavyTailedNonstationary2022/" data-for="@barigozziInferenceHeavyTailedNonstationary2022">Inference in Heavy-Tailed Nonstationary Multivariate Time Series</a></li><li><a href="/notes/Information-is-relative/" data-for="Information-is-relative">Information is relative</a></li><li><a href="/notes/Information-is-surprisal/" data-for="Information-is-surprisal">Information is surprisal</a></li><li><a href="/notes/Interaction-generates-non-normality/" data-for="Interaction-generates-non-normality">Interaction generates non-normality</a></li><li><a href="/notes/Invest-in-companies-like-you-invest-in-your-career/" data-for="Invest-in-companies-like-you-invest-in-your-career">Invest in companies like you invest in your career</a></li><li><a href="/notes/Iterative-tinkering-enhances-effective-IQ/" data-for="Iterative-tinkering-enhances-effective-IQ">Iterative tinkering enhances effective IQ</a></li><li><a href="/notes/Just-do-more/" data-for="Just-do-more">Just do more</a></li><li><a href="/notes/Labor-relationships-have-debt-like-features/" data-for="Labor-relationships-have-debt-like-features">Labor relationships have debt-like features</a></li><li><a href="/notes/@barigozziLargedimensionalDynamicFactor2021/" data-for="@barigozziLargedimensionalDynamicFactor2021">Large-dimensional Dynamic Factor Models: Estimation of Impulse–Response Functions with I ( 1 ) cointegrated factors</a></li><li><a href="/notes/@adamekLassoInferenceHighDimensional2022/" data-for="@adamekLassoInferenceHighDimensional2022">Lasso Inference for High-Dimensional Time Series</a></li><li><a href="/notes/Learned-representations-are-more-important-than-what-you-do-with-them/" data-for="Learned-representations-are-more-important-than-what-you-do-with-them">Learned representations are more important than what you do with them</a></li><li><a href="/notes/@axlerLinearAlgebraDone/" data-for="@axlerLinearAlgebraDone">Linear Algebra Done Right</a></li><li><a href="/notes/Linearly-separable-problems-are-easy-to-solve/" data-for="Linearly-separable-problems-are-easy-to-solve">Linearly separable problems are easy to solve</a></li><li><a href="/notes/Local-projections/" data-for="Local-projections">Local projections</a></li><li><a href="/notes/Local-projections-vs.-VARs" data-for="Local-projections-vs.-VARs">Local projections vs. VARs</a></li><li><a href="/notes/@liLocalProjectionsVs2023/" data-for="@liLocalProjectionsVs2023">Local Projections vs. VARs: Lessons From Thousands of DGPs</a></li><li><a href="/notes/Look-for-high-talent-and-high-agency/" data-for="Look-for-high-talent-and-high-agency">Look for high talent and high agency</a></li><li><a href="/notes/@nowakMathematicalFoundationsMachine/" data-for="@nowakMathematicalFoundationsMachine">Mathematical Foundations of Machine Learning</a></li><li><a href="/notes/Maximize-the-entropy-of-your-information-sources/" data-for="Maximize-the-entropy-of-your-information-sources">Maximize the entropy of your information sources</a></li><li><a href="/notes/Maximize-your-output-of-testable-ideas/" data-for="Maximize-your-output-of-testable-ideas">Maximize your output of testable ideas</a></li><li><a href="/notes/@karapanagiotiModelSelectionLocal/" data-for="@karapanagiotiModelSelectionLocal">Model Selection for Local Projections Instrumental Variable Methods - Empirical Application to Government Spending Multipliers.</a></li><li><a href="/notes/@jordaModelFreeImpulseResponses2003/" data-for="@jordaModelFreeImpulseResponses2003">Model-Free Impulse Responses</a></li><li><a href="/notes/Moving-average-model/" data-for="Moving-average-model">Moving average model</a></li><li><a href="/notes/Network-egress-is-a-lock-in-tactic-for-public-cloud-providers/" data-for="Network-egress-is-a-lock-in-tactic-for-public-cloud-providers">Network egress is a lock-in tactic for public cloud providers</a></li><li><a href="/notes/Not-all-spurious-correlation-is-random/" data-for="Not-all-spurious-correlation-is-random">Not all spurious correlation is random</a></li><li><a href="/notes/Observe-before-you-analyze/" data-for="Observe-before-you-analyze">Observe before you analyze</a></li><li><a href="/notes/@greenwaldOriginsStockMarket2014/" data-for="@greenwaldOriginsStockMarket2014">Origins of Stock Market Fluctuations</a></li><li><a href="/notes/Perfect-competition-is-not-optimal-under-increasing-returns-to-scale/" data-for="Perfect-competition-is-not-optimal-under-increasing-returns-to-scale">Perfect competition is not optimal under increasing returns to scale</a></li><li><a href="/notes/Planning-your-time-is-like-choosing-to-dance-on-beat/" data-for="Planning-your-time-is-like-choosing-to-dance-on-beat">Planning your time is like choosing to dance on beat</a></li><li><a href="/notes/Pre-train-your-representations-before-learning-judgement/" data-for="Pre-train-your-representations-before-learning-judgement">Pre-train your representations before learning judgement</a></li><li><a href="/notes/Prediction-is-compression,-compression-is-expression/" data-for="Prediction-is-compression,-compression-is-expression">Prediction is compression, compression is expression</a></li><li><a href="/notes/Principal-component-analysis/" data-for="Principal-component-analysis">Principal component analysis</a></li><li><a href="/notes/@hamiltonPrincipalComponentAnalysis/" data-for="@hamiltonPrincipalComponentAnalysis">Principal Component Analysis for Nonstationary Series</a></li><li><a href="/notes/@baiPrincipalComponentsEstimation2013/" data-for="@baiPrincipalComponentsEstimation2013">Principal components estimation and identification of static factors</a></li><li><a href="/notes/Random-walk/" data-for="Random-walk">Random walk</a></li><li><a href="/notes/residuals/" data-for="residuals">residuals</a></li><li><a href="/notes/self-supervised-learning/" data-for="self-supervised-learning">self-supervised learning</a></li><li><a href="/notes/@budaShortVariableLags2023/" data-for="@budaShortVariableLags2023">Short and Variable Lags</a></li><li><a href="/notes/@crumpSparseTrendEstimation2023/" data-for="@crumpSparseTrendEstimation2023">Sparse Trend Estimation</a></li><li><a href="/notes/@hsuSubsetSelectionVector2008/" data-for="@hsuSubsetSelectionVector2008">Subset selection for vector autoregressive processes using Lasso</a></li><li><a href="/notes/@taylorSystematicShiftsScaling2021/" data-for="@taylorSystematicShiftsScaling2021">Systematic shifts in scaling behavior based on organizational strategy in universities</a></li><li><a href="/notes/@hoyosTariffsGrowthHeterogeneous/" data-for="@hoyosTariffsGrowthHeterogeneous">Tariffs and Growth: Heterogeneous Eﬀects by Economic Structure</a></li><li><a href="/notes/@zouAdaptiveLassoIts2006/" data-for="@zouAdaptiveLassoIts2006">The Adaptive Lasso and Its Oracle Properties</a></li><li><a href="/notes/@parkBayesianLasso2008/" data-for="@parkBayesianLasso2008">The Bayesian Lasso</a></li><li><a href="/notes/@fernaldDisappointingRecoveryOutput2017/" data-for="@fernaldDisappointingRecoveryOutput2017">The Disappointing Recovery of Output after 2009</a></li><li><a href="/notes/@bayerLiquidityChannelFiscal2020/" data-for="@bayerLiquidityChannelFiscal2020">The Liquidity Channel of Fiscal Policy</a></li><li><a href="/notes/Under-fat-tails,-look-for-quick-reasons-to-say-yes/" data-for="Under-fat-tails,-look-for-quick-reasons-to-say-yes">Under fat tails, look for quick reasons to say yes</a></li><li><a href="/notes/Under-fat-tails,-outliers-drive-movements-in-the-mean/" data-for="Under-fat-tails,-outliers-drive-movements-in-the-mean">Under fat tails, outliers drive movements in the mean</a></li><li><a href="/notes/Under-fat-tails,-unbiasedness-is-overrated/" data-for="Under-fat-tails,-unbiasedness-is-overrated">Under fat tails, unbiasedness is overrated</a></li><li><a href="/notes/Use-TK-liberally/" data-for="Use-TK-liberally">Use TK liberally</a></li><li><a href="/notes/variance/" data-for="variance">variance</a></li><li><a href="/notes/Vector-autoregression/" data-for="Vector-autoregression">Vector autoregression</a></li><li><a href="/notes/@bardesVICRegVarianceInvarianceCovarianceRegularization2021/" data-for="@bardesVICRegVarianceInvarianceCovarianceRegularization2021">VICReg: Variance-Invariance-Covariance Regularization for Self-Supervised Learning</a></li><li><a href="/notes/Volatility-is-information/" data-for="Volatility-is-information">Volatility is information</a></li><li><a href="/notes/When-in-doubt,-don't-difference/" data-for="When-in-doubt,-don't-difference">When in doubt, don't difference</a></li><li><a href="/notes/When-unskilled,-complicate-the-game-and-add-randomness/" data-for="When-unskilled,-complicate-the-game-and-add-randomness">When unskilled, complicate the game and add randomness</a></li><li><a href="/notes/With-the-right-representation,-judgement-is-cheap/" data-for="With-the-right-representation,-judgement-is-cheap">With the right representation, judgement is cheap</a></li></ul></div></li><li id="explorer-end"></li></ul></div></div></div></div><footer class><hr/><ul><li><a href="https://whoisnnamdi.com">whoisnnamdi.com</a></li><li><a href="https://x.com/whoisnnamdi">X</a></li><li><a href="https://www.linkedin.com/in/nnamdiiregbulem">LinkedIn</a></li><li><a href="https://github.com/whoisnnamdi">GitHub</a></li></ul></footer></div></body><script type="application/javascript">function c(){let t=this.parentElement;t.classList.toggle("is-collapsed");let l=t.classList.contains("is-collapsed")?this.scrollHeight:t.scrollHeight;t.style.maxHeight=l+"px";let o=t,e=t.parentElement;for(;e;){if(!e.classList.contains("callout"))return;let n=e.classList.contains("is-collapsed")?e.scrollHeight:e.scrollHeight+o.scrollHeight;e.style.maxHeight=n+"px",o=e,e=e.parentElement}}function i(){let t=document.getElementsByClassName("callout is-collapsible");for(let s of t){let l=s.firstElementChild;if(l){l.addEventListener("click",c),window.addCleanup(()=>l.removeEventListener("click",c));let e=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=e+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script type="module">
          let mermaidImport = undefined
          document.addEventListener('nav', async () => {
            if (document.querySelector("code.mermaid")) {
              mermaidImport ||= await import('https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.7.0/mermaid.esm.min.mjs')
              const mermaid = mermaidImport.default
              const darkMode = document.documentElement.getAttribute('saved-theme') === 'dark'
              mermaid.initialize({
                startOnLoad: false,
                securityLevel: 'loose',
                theme: darkMode ? 'dark' : 'default'
              })

              await mermaid.run({
                querySelector: '.mermaid'
              })
            }
          });
          </script><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">
            const socket = new WebSocket('ws://localhost:3001')
            // reload(true) ensures resources like images and scripts are fetched again in firefox
            socket.addEventListener('message', () => document.location.reload(true))
          </script><script src="/notes/postscript.js" type="module"></script></html>